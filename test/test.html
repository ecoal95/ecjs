<!DOCTYPE html>
<!--[if lt IE 7 & (!IEMobile)]>
<html class="ie ie6 lt-ie7 lt-ie8 lt-ie9 no-js">
<![endif]-->
<!--[if (IE 7) & (!IEMobile)]>
<html class="ie ie7 lt-ie8 lt-ie9 no-js">
<![endif]-->
<!--[if (IE 8) & (!IEMobile)]>
<html class="ie ie8 lt-ie9 no-js">
<![endif]-->
<!--[if IE 9 & (!IEMobile)]>
<html class="ie ie9 no-js">
<![endif]-->
<!--[if (gt IE 9) | (IEMobile) | !(IE)  ]><!-->
<html class="no-js">
<!--<![endif]-->
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
	<meta charset="utf-8">

	<title>EC.js</title>
	<meta property="og:title" content="EC.js">
</head>
<body>
	<div class="container">
		<a href="#">1</a>
		<a href="#">2</a>
		<a href="#">3</a>
		<a href="#">3</a>
		<a href="#">4</a>
	</div>
	<script src="../src/ec.js"></script>
	<script>
		EC.load(['DOM', 'request'], function() {
			console.log( 'todo cargado' );

			// Ésto sólo funcionará con el primero
			EC.DOM.select('a').first().on('click', function(e) {
				e.preventDefault();
				this.style.color = '#111';
			});

			// Delegated
			EC.DOM.select('.container').on('click', 'a', function(e) {
				e.preventDefault();
				this.style.textDecoration = 'none';
			})
		
			EC.request.post({
				url: 'https://www.googleapis.com/urlshortener/v1/url',
				type: 'json',
				data: JSON.stringify({
					longUrl: 'http://emiliocobos.net/'
				}),
				proccessData: false,
				requestContentType: 'application/json',
				onsuccess: function(data) {
					var link = EC.DOM.create('a', {
						href: data.id,
						attributes: {
							'data-longurl': data.longUrl
						},
						target: '_blank',
						innerHTML: 'Url acortada',
						style: {
							fontSize: '2em',
							color: 'red'
						}
					}).appendTo('.container').appendTo('body');
				}
			})
		})

	</script>
</body>
</html>