/*! EC.js - v0.1.0 - 2013-05-07
* Copyright (c) 2013 Emilio Cobos Álvarez; Licensed MIT */
(function(t,e){"use strict";EC.DOM=EC.DOM||{};var n=function(t){for(var e=[],n=t.length;n--;e.unshift(t[n]));return e},r=function(){var t={};return function(e){return t.hasOwnProperty(e)||(t[e]=RegExp("\\b("+e+")\\b","g")),t[e]}}();EC.core.extend(EC.DOM,{select:function(t,e){return new EC.DOMInstance(t,e)},create:function(t,e){var n,r=document.createElement(t);for(n in e)e.hasOwnProperty(n)&&"style"!==n&&"attributes"!==n&&(r[n]=e[n]);if(e.style&&EC.core.extend(r.style,e.style),e.attributes)for(n in e.attributes)e.attributes.hasOwnProperty(n)&&r.setAttribute(n,e.attributes[n]);return EC.DOM.select(r)},supportsProp:function(){var e=document.createElement("_"),n={},r=["Webkit","Moz","Ms","O","webkit","moz","ms","o"],s=r.length;return function(o,i){var c,u=0;if(n[o])return n[o];if(c=i?"boolean"==typeof i?e:i:t,o in c)return n[o]=o,o;for(o=o.charAt(0).toUpperCase()+o.substring(1);s>u;u++)if(r[u]+o in c)return n[o]=r[u]+o,n[o];return!1}}(),matchesSelector:function(t,e){var n;if(n=EC.DOM.supportsProp("matchesSelector",t))return t[n](e);switch(e.substring(0,1)){case".":return r(e.substring(1)).test(t.className);case"#":return t.id===e.substring(1);default:return t.nodeName.toLowerCase()===e.toLowerCase()}},event:{add:function(n,r,s,o){var i=function(r){return r=r||t.event,r.preventDefault||(r.preventDefault=function(){r.returnValue=!1}),r.stopPropagation||(r.stopPropagation=function(){r.cancelBubble=!0}),r.target||(r.target=r.srcElement),!r.keyCode&&r.which&&(r.keyCode=r.which),s?(EC.DOM.matchesSelector(r.target,s)&&o.call(r.target,r),e):(o.call(n,r),e)};return o||(o=s,s=null),n.addEventListener?n.addEventListener(r,i,!1):n.attachEvent("on"+r,i),!0}}}),EC.DOMInstance=function(t,e){if(e&&(("string"==typeof e||e.nodeType)&&(e=new EC.DOMInstance(e)),e instanceof EC.DOMInstance))return e.find(t);if(t){if(t.nodeType)this.els=[t];else if("string"==typeof t)switch(t){case"body":this.els=[document.body];break;case"html":this.els=[document.documentElement];break;default:this.els=/^#([0-9A-Z-_])$/i.test(t)?[document.getElementById(RegExp.$1)]:n(document.querySelectorAll(t))}}else this.els=[];return this},EC.core.extend(EC.DOMInstance.prototype,{els:[],forEach:function(t){return EC.core.forEach(this.els,t),this},attr:function(t,n){var r;return n===e?(r=this.els[0])?r.getAttribute(t):null:this.forEach(function(e){e.setAttribute(t,n)})},addClass:function(t){var e=r(t);return this.forEach(function(n){e.test(n.className)||(n.className+=" "+t)})},removeClass:function(t){var e=r(t.split(" ").join("|"));return this.forEach(function(t){t.className=t.className.replace(e,"")})},hasClass:function(t){var e,n=r(t);return(e=this.els[0])?n.test(e.className):!1},get:function(t){return t!==e?this.els[t]:this.els},first:function(t){var n=this.els[0];return t===e?new EC.DOMInstance(n):new EC.DOMInstance(n.querySelector(t))},append:function(t){var e=this.els[0];if(e)return"string"==typeof t?e.innerHTML+=t:t instanceof EC.DOMInstance?t.forEach(function(t){e.appendChild(t)}):e.appendChild(t),this},appendTo:function(t){return("string"==typeof t||t.nodeType)&&(t=EC.DOM.select(t)),this.forEach(function(e){t.append(e)})},on:function(t,e,n){return this.forEach(function(r){EC.DOM.event.add(r,t,e,n)})},find:function(t){var e=[],r=new EC.DOMInstance;return this.forEach(function(r){e=e.concat(n(r.querySelectorAll(t)))}),r.els=e,r},css:function(t,n){return n!==e?this.forEach(function(e){e.style[t]=n}):this.forEach(function(e){var n;for(n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n])})},remove:function(){return this.forEach(function(t){t.parentNode&&t.parentNode.removeChild(t)})},animate:function(){var t,e=EC.DOM.supportsProp("transition",document.documentElement.style),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};return e===!1?function(t,e,n,r){return this.css(t),r&&"function"==typeof r?this.forEach(function(t){r.call(t)}):this}:(t=n[e],function(n,r,s,o){var i,c=[];if(!this.els[0])return this;r||(r=600),s||(s="ease"),r/=1e3;for(i in n)n.hasOwnProperty(i)&&c.push(i+" "+r+"s "+s);return c=c.join(","),o&&"function"==typeof o&&this.forEach(function(e){e.addEventListener(t,function n(r){o.call(e,r),e.removeEventListener(t,n)},!1)}),this.forEach(function(t){t.style[e]=c}),this.els[0].offsetWidth,this.css(n)})}()}),"function"!=typeof t.$&&(t.$=EC.DOM.select),document.querySelectorAll||function(){var e=document.documentElement.firstChild,n=document.createElement("style");e.appendChild(n),document.querySelectorAll=function(e){return document.__qsaels=[],n.styleSheet.cssText=e+"{x:expression(document.__qsaels.push(this))}",t.scrollBy(0,0),document.__qsaels}}(),document.querySelector||(document.querySelector=function(t){return document.querySelectorAll(t)[0]||null})})(window);